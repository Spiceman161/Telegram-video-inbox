# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞ —Å —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ–º —Å—Ç–æ—Ä–æ–Ω –≤–∏–¥–µ–æ - –°–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üìã –†–µ–∑—é–º–µ

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –≤–∏–¥–µ–æ, —Å–∫–∞—á–∞–Ω–Ω–æ–µ —á–µ—Ä–µ–∑ –±–æ—Ç–∞, –∏–º–µ–ª–æ –∏—Å–∫–∞–∂–µ–Ω–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω (—Ä–∞—Å—Ç—è–Ω—É—Ç–æ–µ –ø–æ —à–∏—Ä–∏–Ω–µ). –ü—Ä–æ–±–ª–µ–º–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ Telegram, –Ω–∞ TV-BOX –≤–∏–¥–µ–æ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–ª–æ—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í–∏–¥–µ–æ —Ä–∞—Å—Ç—è–Ω—É—Ç–æ –ø–æ —à–∏—Ä–∏–Ω–µ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞
- –ù–∞ TV-BOX —Ç–æ –∂–µ –≤–∏–¥–µ–æ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- –ü—Ä–æ–±–ª–µ–º–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —á–µ—Ä–µ–∑ `send_video()`

**–ü—Ä–∏—á–∏–Ω–∞:**
Telegram Bot API –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `send_video()` –±–µ–∑ —è–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ `width` –∏ `height` —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–∏–¥–µ–æ –∏ –º–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∏—Å–∫–∞–∂–µ–Ω–∏—é.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ —Å –ø–æ–º–æ—â—å—é `ffprobe` –∏ –ø–µ—Ä–µ–¥–∞—á–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ `send_video()`:

```python
metadata = get_video_metadata(file_info.path)
if metadata:
    await context.bot.send_video(
        chat_id=update.effective_chat.id,
        video=file_info.path,
        caption=f"üìπ {file_info.name}",
        width=metadata['width'],      # ‚Üê –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —à–∏—Ä–∏–Ω—ã
        height=metadata['height'],    # ‚Üê –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –≤—ã—Å–æ—Ç—ã
        duration=metadata.get('duration'),
        supports_streaming=True
    )
```

## üì¶ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

1. **`bot/utils/video_metadata.py`**
   - –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ffprobe` (—á–∞—Å—Ç—å ffmpeg)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `width`, `height`, `duration`
   - Silent fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

2. **`docs/ASPECT_RATIO_FIX.md`**
   - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
   - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–∞–±–æ—Ç—ã —Å ffprobe
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

3. **`docs/TESTING_ASPECT_RATIO.md`**
   - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏ —Ä—É—á–Ω–æ–π —Ç–µ—Å—Ç—ã
   - Troubleshooting guide

4. **`scripts/test_aspect_ratio_fix.sh`**
   - –°–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ ffprobe
   - –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

5. **`CHANGELOG.md`**
   - –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
   - –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

## üîß –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`bot/handlers/callbacks.py`**
   - –§—É–Ω–∫—Ü–∏—è `handle_download()` ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
   - Fallback –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –±–µ–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—à–∏–±–∫–µ

2. **`README.md`**
   - –î–æ–±–∞–≤–ª–µ–Ω `ffmpeg` –≤ —Å–ø–∏—Å–æ–∫ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏: `pkg install python git ffmpeg`

3. **`docs/INSTALLATION.md`**
   - –î–æ–±–∞–≤–ª–µ–Ω `ffmpeg` –≤ —à–∞–≥ 3.2 (–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤)

## üì• –ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **ffmpeg** (—Å–∏—Å—Ç–µ–º–Ω—ã–π –ø–∞–∫–µ—Ç)
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑: `pkg install ffmpeg`
  - –í–∫–ª—é—á–∞–µ—Ç `ffprobe` - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
  - –û–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ ffprobe
ffprobe -version

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
cd ~/telegram-video-inbox
chmod +x scripts/test_aspect_ratio_fix.sh
./scripts/test_aspect_ratio_fix.sh
```

### –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç

1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ –±–æ—Ç—É
2. –ù–∞–∂–∞—Ç—å "üì• Inbox" ‚Üí –≤—ã–±—Ä–∞—Ç—å –≤–∏–¥–µ–æ ‚Üí "‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å"
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–∫–∞—á–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ TV-BOX

### –ï—Å–ª–∏ –±–æ—Ç —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ TV-BOX:

```bash
# 1. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
cd ~/telegram-video-inbox
git pull

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ffmpeg
pkg install ffmpeg

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
pkill -f "python bot/main.py"
./scripts/start_bot.sh &
```

### –ï—Å–ª–∏ —ç—Ç–æ –Ω–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:

–°–ª–µ–¥—É–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ `docs/INSTALLATION.md` - ffmpeg —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–µ–Ω –≤ —à–∞–≥ 3.2.

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ ffprobe –¥–æ—Å—Ç—É–ø–µ–Ω
which ffprobe

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤–∏–¥–µ–æ
tail -f ~/telegram-video-inbox/logs/bot.log | grep "file_sent"
```

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ –ø–æ –∫–∞–∫–∏–º-—Ç–æ –ø—Ä–∏—á–∏–Ω–∞–º –Ω–µ–ª—å–∑—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ffmpeg, –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–∏–¥–µ–æ –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç—ã:

```env
# –í .env —Ñ–∞–π–ª–µ
SEND_AS=document
```

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ—Ç preview –≤ —á–∞—Ç–µ
- –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –ø–ª–µ–µ—Ä–∞
- –ë–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä –ø—Ä–µ–≤—å—é

**–ü–ª—é—Å—ã:**
- Telegram –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–∏–¥–µ–æ
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è ffmpeg

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **–ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤**: 5
- **–ò–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤**: 3
- **–ù–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**: 1 (ffmpeg)
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–æ**: ~300
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π**: –°—Ä–µ–¥–Ω—è—è (5/10)

## üéØ –ò—Ç–æ–≥

–ë–∞–≥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω. –í–∏–¥–µ–æ —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞. –†–µ—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫—Ä–æ–º–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ ffmpeg).

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 2026-01-06  
**–ê–≤—Ç–æ—Ä**: Antigravity AI Assistant  
**–í–µ—Ä—Å–∏—è**: 1.0.0
